CREATE TABLE IF NOT EXISTS developer (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS genre (
    id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    name VARCHAR(255) NOT NULL UNIQUE,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS platform (
    id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    name VARCHAR(255) NOT NULL UNIQUE,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS game (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    description VARCHAR(255),
    release_date DATE,
    title VARCHAR(255) NOT NULL,
    developer_id BIGINT,
    CONSTRAINT FK_game_developer FOREIGN KEY (developer_id) REFERENCES developer(id)
);

CREATE TABLE IF NOT EXISTS role (
    id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    name VARCHAR(255) CHECK (name IN ('ADMIN', 'USER')) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "user" (
    id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    password VARCHAR(255) NOT NULL,
    username VARCHAR(255) NOT NULL UNIQUE,
    role_id BIGINT NOT NULL,
    PRIMARY KEY (id),
    CONSTRAINT FK_role_id FOREIGN KEY (role_id) REFERENCES role(id)
);

CREATE TABLE IF NOT EXISTS game_genre (
    game_id BIGINT NOT NULL,
    genre_id BIGINT NOT NULL,
    PRIMARY KEY (game_id, genre_id),
    CONSTRAINT FK_game_genre_game FOREIGN KEY (game_id) REFERENCES game(id),
    CONSTRAINT FK_game_genre_genre FOREIGN KEY (genre_id) REFERENCES genre(id)
);

CREATE TABLE IF NOT EXISTS game_platform (
    game_id BIGINT NOT NULL,
    platform_id BIGINT NOT NULL,
    PRIMARY KEY (game_id, platform_id),
    CONSTRAINT FK_game_platform_game FOREIGN KEY (game_id) REFERENCES game(id),
    CONSTRAINT FK_game_platform_platform FOREIGN KEY (platform_id) REFERENCES platform(id)
);